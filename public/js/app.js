$("form[name='game-settings']").find("select").on("change",function(){$(this).closest("form").trigger("submit"),$(this).is("select[name='type']")&&("quotes"===$(this).val()?$("select[name='count']").hide():$("select[name='count']").show())}),$("#words").on("click",function(){$("#words-input").focus()}),$("form[name='game-settings']").ajaxForm({success:function(e){$("#words").html(""),Array.isArray(e)?e.forEach(e=>{var t,s=$('<div class="word"></div>').appendTo("#words");for(t of e)s.append(`<span class="letter">${t}</span>`);s.append('<span class="letter">&nbsp;</span>')}):e.text.split(" ").forEach(e=>{var t,s=$('<div class="word"></div>').appendTo("#words");for(t of e)s.append(`<span class="letter">${t}</span>`);s.append('<span class="letter">&nbsp;</span>')}),window.TOTAL_LETTERS=$(".letter").length,$("#words-input").focus(),resetGame()}}),$("#words-input").on("focus",function(){$("#words").removeClass("blurred"),$("#caret").show(),$("#blurred-message").addClass("hidden"),$._data($(this)[0],"events").keydown||$(this).on("keydown",function(o){var e;window.GAME_STATUS="running",window.TYPABLE_KEYS.some(({keyCode:e,char:t,shiftChar:s})=>o.key===t||o.key===s||o.which===e)?(e=window.CURRENT_LETTER_INDEX,(o.key===$($(".letter").get(e)).text()?$($(".letter").get(e)).addClass("correct"):$($(".letter").get(e)).addClass("incorrect")).closest("#word").addClass(["typed","active"]),++e<$(".letter").length&&($("#caret").css("left",$(".letter").get(e).offsetLeft+"px"),$("#caret").css("top",$(".letter").get(e).offsetTop+"px"),window.CURRENT_LETTER_INDEX=e)):"Backspace"===o.key&&(e=window.CURRENT_LETTER_INDEX,e--,$($(".letter").get(e)).removeClass(["incorrect","correct"]),0<=e)&&($("#caret").css("left",$(".letter").get(e).offsetLeft+"px"),$("#caret").css("top",$(".letter").get(e).offsetTop+"px"),window.CURRENT_LETTER_INDEX=e)})}).on("blur",function(){$("#words").addClass("blurred"),$("#blurred-message").removeClass("hidden"),$("#caret").hide(),$(this).off("keydown")}),$(()=>{window.GAME_STATUS="stop",$("form[name='game-settings']").trigger("submit"),$("#words-input").focus(),resetGame()});
